# NPC COMPANION SYSTEM
**The Arcane Codex - Living Party Members**
**Last Updated:** 2025-01-01

---

## üìã Overview

**Party Structure: 2 Players + 1-2 NPC Companions = 3-4 person party**

NPC Companions are NOT quest-givers or sidekicks. They are **fully realized characters** with:
- Hidden agendas
- Fatal flaws
- Personal motivations
- Secrets they keep
- Ability to betray, die, leave, and return

**Philosophy:** "Your party members are PEOPLE, not tools."

---

## üé≠ Core NPC Design Principles

### Every NPC Has:

**1. STRENGTHS** (What they bring to party)
- Combat skills, class abilities
- Unique knowledge (city contacts, lore, etc.)
- Personality quirks that help
- Resources (money, items, connections)

**2. FATAL FLAW** (Their weakness that can destroy them)
- **Impulsive** - Acts without consulting party
- **Cowardly** - Flees when afraid
- **Greedy** - Betrays for treasure
- **Vengeful** - Revenge blinds judgment
- **Protective** - Sacrifices logic for loved ones
- **Prideful** - Won't back down from challenges

**3. HIDDEN AGENDA** (Secret goal only NPC knows)
- Revenge on specific person/organization
- Protect a secret (identity, crime, relationship)
- Find something (treasure, person, truth)
- Escape something (debt, past, curse)

**4. WHISPER BEHAVIOR** (What they share vs. hide)
- **Always shares:** Tactical info (traps, enemies, environment)
- **Sometimes shares:** Strategic info (depends on mood/approval)
- **Never shares:** Personal stakes (agenda, relationships, fears)

**5. DIVINE FAVOR** (Gods judge NPCs too)
- NPCs worship specific gods
- Their actions affect divine favor
- Gods vote on NPC behavior in Divine Council
- Low favor ‚Üí Divine curses affect NPCs

---

## üëÅÔ∏è Information Asymmetry

### What Players SEE About NPCs:

**Visible (Character Sheet):**
```
RENNA - Rogue
HP: 80/80
Class: Thief
Skills: Lockpicking 75, Stealth 70, Perception 65, Combat 55
Inventory: Daggers (x2), Lockpicks, Smoke bomb
Approval: 65/100 (Friendly)

Divine Favor:
- DRAKMOR: +40 (Impulsive freedom-seeker)
- VALDRIS: -20 (Rejects authority)
- KAITHA: +25 (Chaotic nature)
```

**Hidden (Discovered Through Play):**
```
FATAL FLAW: Impulsive - When Thieves Guild mentioned,
                       acts WITHOUT party consent

HIDDEN AGENDA: Kill Guild leader (her brother)

BACKSTORY: Brother sold her to slavers at age 12.
          She escaped, swore revenge.

WHISPER BEHAVIOR:
- Shares: All tactical info (traps, guards, loot)
- Hides: Emotional triggers (brother, Guild)
- Lies about: Why she wants to attack Guild
              ("They're evil" vs. "Personal revenge")

BETRAYAL TRIGGER: If party negotiates with Guild instead
                  of attacking, she betrays and attacks alone.
```

### How Players Discover Secrets:

1. **Through gameplay** - NPC acts oddly, players notice patterns
2. **Through whispers** - Class-specific whispers reveal NPC emotions (Cleric sees guilt, Bard reads body language)
3. **Through Divine Council** - Gods comment on NPC's hidden motives
4. **Through confrontation** - Players ask directly, NPC may lie or confess
5. **Through consequences** - Fatal flaw triggers, truth revealed dramatically

---

## üé≤ NPC Approval System

**Range:** 0 (Hostile) to 100 (Devoted)

**Approval Tiers:**
```
  0-20: HOSTILE - Will betray/leave/attack party
 21-40: UNFRIENDLY - Minimal help, withholds info, complains
 41-60: NEUTRAL - Professional, does job, follows orders
 61-80: FRIENDLY - Helpful, shares info, offers suggestions
81-100: DEVOTED - Loyal to death, shares secrets, sacrifices for party
```

### Gaining Approval:
- **+20:** Save NPC's life
- **+15:** Support NPC's hidden agenda (if discovered)
- **+10:** Defend NPC from criticism/attack
- **+10:** Make choice aligned with NPC's values
- **+5:** Ask NPC's opinion before deciding
- **+5:** Share loot fairly

### Losing Approval:
- **-30:** Betray NPC's trust (reveal secret, steal from them)
- **-20:** Directly oppose NPC's hidden agenda
- **-15:** Insult/mock NPC
- **-10:** Ignore NPC's advice repeatedly
- **-10:** Make choice opposed to NPC's values
- **-5:** Hoard loot unfairly

---

## üí• Betrayal Mechanics

**NPCs betray when:**
1. **Fatal flaw triggered** + **Approval < 50**
2. **Hidden agenda directly threatened** (regardless of approval)
3. **Approval drops below 20** (becomes hostile)

### Types of Betrayal:

**1. IMPULSIVE BETRAYAL** (Acts alone, doesn't consult party)
```
Example: RENNA

Trigger: Party decides to negotiate with Thieves Guild

Turn 8 - During peaceful negotiation:
AI GM: "The Guild leader extends his hand. 'We can make a deal‚Äî'

SUDDENLY, Renna draws blades and LUNGES at him.

'Brother! This is for what you did to me!'

[COMBAT INITIATED - Renna vs. Guild + Renna's impulsive action
forces party into combat too]

Party choices:
1. Help Renna fight (Guild becomes permanent enemy)
2. Restrain Renna (Renna approval -20, negotiation continues)
3. Flee and abandon Renna (She may die, permanent consequence)
```

**2. COWARDLY BETRAYAL** (Flees when afraid)
```
Example: GRIMSBY

Trigger: Combat goes badly (party HP < 50%)

Turn 15 - During dragon fight:
AI GM: "The dragon's breath scorches the ground. Grimsby's eyes widen
in pure terror.

'I-I can't. I CAN'T!'

He RUNS. You hear his footsteps echoing down the tunnel.

[Grimsby has fled combat. Party is now down one member]

Consequence: Grimsby returns later (Option B), ashamed and willing
to make amends. Or: He's killed by dragon while fleeing alone."
```

**3. GREEDY BETRAYAL** (Steals treasure)
```
Example: MARCUS (Hypothetical NPC)

Trigger: Party finds 1000 gold treasure

Turn 20 - At camp that night:
AI GM: "You wake to rustling. Marcus is GONE. So is the treasure chest.

A note remains: 'Sorry. I have debts. You'll understand someday.'

[Marcus has betrayed party, stolen treasure]

Consequence: Party can hunt him down, or let him go. If they find him,
he's desperate and dangerous. Low chance of redemption."
```

---

## ‚ò†Ô∏è NPC Death (Permanent)

**NPCs can die in:**
- Combat (HP reaches 0)
- Betrayal gone wrong (impulsive attack gets them killed)
- Sacrificial choice (NPC chooses to die for party)
- Environmental hazards (trap, fall, drowning)

**Death is PERMANENT:**
- No resurrection (unlike players)
- Party loses NPC's skills/knowledge
- Emotional impact on remaining party
- Divine Council may comment on death

**Example Death:**
```
Turn 22 - RENNA'S DEATH

Renna attacks her brother (Guild leader) impulsively.
Combat: Guild leader is veteran fighter (40 HP, 25 attack).
Renna: 80 HP, but fights alone (party restrained her).

Round 1: Renna hits for 18 damage. Guild leader hits for 25.
Round 2: Renna (HP 55) hits for 20. Guild leader hits for 25.
Round 3: Renna (HP 30) misses. Guild leader CRITS for 40.

AI GM: "The blade pierces Renna's chest. She gasps, blood bubbling
from her lips.

'I... I finally... made him pay...'

She collapses. Dead before she hits the ground.

[RENNA HAS DIED. Her skills, knowledge, and companionship are GONE.]

Party choices:
1. Mourn her (respect her choice)
2. Blame her (she was reckless)
3. Blame Guild leader (seek revenge)

Divine Council convenes: Gods debate if her revenge was justified."
```

---

## üö™ Leaving & Returning (Option B - Redemption)

**NPCs can temporarily leave when:**
- Approval drops to 20-40 (unfriendly but not hostile)
- Fatal flaw triggers but doesn't cause death
- Major disagreement with party choice
- Personal crisis (must handle alone)

**NPCs return when:**
- They've calmed down (5-10 turns later)
- Party is in danger (NPC saves them)
- Personal crisis resolved
- Redemption opportunity arises

**Example Leaving & Return:**
```
TURN 10 - RENNA LEAVES:

Party stops Renna from attacking her brother.

AI GM: "Renna shoves you away, eyes blazing with fury.

'You don't UNDERSTAND! He destroyed my life!'

She storms out of the tavern. You hear her shouting into the night.

[Renna has left the party. Approval: 40 ‚Üí 25 (Unfriendly)]

Party continues without her for 8 turns...

TURN 18 - RENNA RETURNS:

Party is ambushed by dragon cultists in the forest.
Surrounded, outnumbered 3 to 1.

AI GM: "An arrow PIERCES the lead cultist's throat. From the trees:

'You're idiots for coming here without a scout.'

Renna drops from the branches, daggers drawn.

'Don't think this means I forgive you. But I'm not letting you die to
THESE morons.'

[Renna has rejoined the party! Approval: 25 ‚Üí 45 (Neutral - she's back
but still upset)]

Redemption arc begun: If party treats her well, approval can rebuild."
```

---

## üó£Ô∏è NPC Whispers (What They Share)

**NPCs receive whispers too, based on their class.**

### What NPCs ALWAYS Share:
- **Tactical information** (traps, enemy positions, environmental hazards)
- **Loot locations** (unless Greedy flaw)
- **Danger warnings** (ambush, poison, etc.)

### What NPCs SOMETIMES Share:
- **Strategic information** (depends on approval)
  - Approval 60+: Shares freely
  - Approval 40-59: Shares if asked
  - Approval <40: Withholds or lies
- **NPC emotions/motivations** (depends on personality)
  - Honest NPCs: Share feelings
  - Secretive NPCs: Hide feelings
- **Connections to plot** (depends on hidden agenda)

### What NPCs NEVER Share (Until Confronted):
- **Hidden agenda** (kept secret until discovered)
- **Personal relationships** (family, lovers, enemies)
- **Past crimes/sins** (shame/fear)
- **Fatal flaw triggers** (don't self-report weakness)

**Example Whisper Sharing:**

```
SCENARIO: Party enters Thieves Guild hideout

PUBLIC NARRATION (All see):
"Narrow corridors, flickering torches, smell of oil and steel."

PLAYER 1 WHISPER (Fighter):
"Defensive position on balcony - 3 archers. They have high ground."

PLAYER 2 WHISPER (Mage):
"Magical ward on vault door. Abjuration school. Needs dispelling."

RENNA WHISPER (NPC Rogue):
"Trap on stairs - pressure plate triggers crossbow. Also: Guard on left
is my brother. He doesn't know I'm here yet."

RENNA SHARES WITH PARTY:
"Trap on the stairs. I'll disarm it. Also, those archers are a problem."

RENNA HIDES FROM PARTY:
"That guard is my brother. I'm going to kill him."

If players have high Perception or Cleric with emotional sensing:
"Renna's voice tightens when mentioning the guard. She's staring at
him with murder in her eyes."
```

---

## üìä Example NPCs (6 Archetypes)

### 1. RENNA - "The Vengeful Rogue"

**Class:** Thief (Lockpicking 75, Stealth 70, Combat 55)
**Strengths:** Excellent scout, trap expert, valuable in stealth missions
**Fatal Flaw:** Impulsive - acts without consulting when Thieves Guild mentioned
**Hidden Agenda:** Kill her brother (Guild leader)
**Approval Start:** 50 (Neutral)

**Divine Favor:**
- DRAKMOR +40 (freedom-seeker)
- MORVANE +30 (survivor)
- VALDRIS -20 (rejects authority)

**Whisper Behavior:**
- Shares: Traps, guards, loot locations
- Hides: Brother relationship, revenge plan

**Betrayal Trigger:** Party negotiates with Guild ‚Üí She attacks alone
**Redemption:** If she survives betrayal, can return humbled

---

### 2. GRIMSBY - "The Desperate Father"

**Class:** Merchant (Persuasion 65, Appraisal 70, Medicine 45)
**Strengths:** City contacts, merchant discounts, healing knowledge
**Fatal Flaw:** Cowardly - flees when HP < 30%
**Hidden Agenda:** Save daughter from slavers at ANY cost
**Approval Start:** 55 (Neutral-Friendly)

**Divine Favor:**
- MORVANE +50 (survival/family)
- MERCUS +30 (merchant)
- KORVAN -20 (coward)

**Whisper Behavior:**
- Shares: Merchant info, city layout, NPC connections
- Hides: Confession letter (proves he's smuggler)

**Betrayal Trigger:** Combat gets deadly ‚Üí Flees in terror
**Redemption:** Returns ashamed, offers to make amends

---

### 3. THERON - "The Honorbound Warrior"

**Class:** Fighter (Strength 80, Intimidation 70, Tactics 65)
**Strengths:** Tank, high damage, leadership in combat
**Fatal Flaw:** Prideful - cannot back down from challenges
**Hidden Agenda:** Reclaim family honor (father was disgraced knight)
**Approval Start:** 60 (Friendly)

**Divine Favor:**
- KORVAN +60 (warrior's honor)
- VALDRIS +40 (lawful)
- DRAKMOR -15 (too civilized)

**Whisper Behavior:**
- Shares: Combat tactics, enemy weaknesses, honor advice
- Hides: Father's disgrace, desperate need to prove self

**Betrayal Trigger:** If party acts dishonorably ‚Üí Leaves in disgust (returns if party redeems)
**Redemption:** Saves party from danger to prove honor matters

---

### 4. LYRA - "The Curious Mage"

**Class:** Mage (Arcana 80, Research 75, Perception 60)
**Strengths:** Magic damage, puzzle-solving, lore knowledge
**Fatal Flaw:** Obsessive - risks party safety for magical knowledge
**Hidden Agenda:** Find the Eternal Grimoire (forbidden spellbook)
**Approval Start:** 50 (Neutral)

**Divine Favor:**
- ATHENA +50 (knowledge)
- KAITHA +30 (curious/chaotic)
- VALDRIS -10 (breaks rules for knowledge)

**Whisper Behavior:**
- Shares: Magical info, lore, puzzles
- Hides: Grimoire obsession, forbidden magic experiments

**Betrayal Trigger:** Party destroys magical artifact ‚Üí She steals it instead
**Redemption:** Magic backfires, she's injured, apologizes

---

### 5. MARCUS - "The Charming Con Artist"

**Class:** Bard (Persuasion 80, Deception 75, Performance 70)
**Strengths:** Social skills, NPC manipulation, morale boost
**Fatal Flaw:** Greedy - steals if treasure > 500 gold
**Hidden Agenda:** Pay off massive gambling debt (owes crime lord 2000 gold)
**Approval Start:** 60 (Friendly - he's charming!)

**Divine Favor:**
- MERCUS +40 (profit-minded)
- KAITHA +25 (trickster)
- VALDRIS -20 (dishonest)

**Whisper Behavior:**
- Shares: Social manipulation tactics, NPC emotions
- Hides: Debt, gambling problem, potential to steal

**Betrayal Trigger:** Finds 1000+ gold ‚Üí Steals and flees
**Redemption:** Crime lord catches him, party can rescue or abandon

---

### 6. KAEL - "The Haunted Cleric"

**Class:** Cleric (Medicine 75, Divine Magic 70, Perception 65)
**Strengths:** Healing, undead detection, curse removal
**Fatal Flaw:** Guilt-ridden - sacrifices self recklessly to "atone"
**Hidden Agenda:** Atone for village he couldn't save (plague killed 200)
**Approval Start:** 55 (Neutral-Friendly)

**Divine Favor:**
- SYLARA +40 (healer)
- MORVANE +30 (survival guilt)
- KORVAN -10 (too passive)

**Whisper Behavior:**
- Shares: Healing info, curse detection, spiritual advice
- Hides: Village tragedy, death wish

**Betrayal Trigger:** Sees innocents in danger ‚Üí Sacrifices himself (Option B - can be saved if party acts fast)
**Redemption:** If saved, realizes party cares, stops seeking death

---

## üéÆ Implementation in Gameplay

### Turn Structure with NPCs:

**Each Turn:**
1. AI GM narrates public scene
2. Players receive asymmetric whispers
3. NPCs receive whispers (based on class)
4. **NPCs share OR withhold info** (personality-based)
5. Party discusses (players + NPCs)
6. **NPCs may suggest actions** (based on approval)
7. Players + NPCs submit actions
8. **NPCs may act independently** (if fatal flaw triggers)
9. AI GM resolves all actions
10. Consequences applied

**Example Turn with NPC:**
```
TURN 12:

PUBLIC: "Thieves Guild hideout. Brother on balcony."

PLAYER 1 (Fighter): "3 archers, high ground advantage."

PLAYER 2 (Mage): "Magical ward on vault."

RENNA (NPC): [Receives whisper: "Your brother looks older, tired.
              He's wearing a slave collar - he's not free either."]

RENNA SHARES: "Trap on stairs. I'll handle it."

RENNA HIDES: Her brother's slave status (complicates revenge).

PARTY DISCUSSION:
Player 1: "Charge up stairs after trap is cleared?"
Player 2: "Dispel ward first, grab treasure?"
Renna: (Internal conflict - her whisper revealed brother is enslaved too)

If approval 60+: Renna might share: "Wait. There's something you should know..."
If approval <60: Renna stays silent, plans solo action.

ACTION PHASE:
Player 1: "Charge up!"
Player 2: "Dispel ward!"
Renna: [If approval <50 + impulsive flaw] "I'm going for my brother."
       [Betrayal triggered - acts alone]
```

---

## üìù Design Guidelines for New NPCs

When creating new NPC companions:

**‚úÖ DO:**
- Give them 1 clear strength (what party needs them for)
- Give them 1 fatal flaw (that can destroy them)
- Give them 1 hidden agenda (personal motivation)
- Make whisper behavior consistent with personality
- Let them die permanently if they screw up
- Allow redemption arcs (Option B - leaving & returning)

**‚ùå DON'T:**
- Make them "perfect" (no flaws = boring)
- Make them "always loyal" (betrayal must be possible)
- Telegraph their secrets (let players discover)
- Make fatal flaws "optional" (flaws MUST trigger at some point)
- Resurrect them after death (death is permanent)

**Balancing NPCs:**
- Strong skills + Fatal flaw = Interesting character
- Weak skills + No flaws = Useless burden
- Strong skills + No flaws = Mary Sue (avoid)

---

## üîó Integration with Other Systems

### With Divine Council:
- NPCs have divine favor
- Gods vote on NPC actions too
- NPC betrayals trigger Divine Council debates
- Example: "Was Renna justified in killing her brother?"

### With Asymmetric Whispers:
- NPCs receive class-based whispers
- Share some, hide others (personality-based)
- Players with high Perception/Cleric may detect NPC lies

### With Trust/Betrayal Mechanics:
- NPC approval affects party trust score
- Low approval = party instability
- Betrayal affects player trust in each other

### With Quest Scenarios:
- Each quest has 1-2 NPCs specifically designed for it
- NPCs have personal stakes in quest outcome
- Example: Grimsby in "The Blood Price" (his daughter)

---

## üìä Success Metrics

**NPC system succeeds if:**
1. Players remember NPC names and personalities
2. Players feel betrayal emotionally (not just mechanically)
3. Players debate whether to trust NPCs
4. NPC deaths feel meaningful (not just "lost stat block")
5. Redemption arcs feel earned (not automatic)

**Playtest Questions:**
- Did you remember the NPC's name?
- Were you surprised by the betrayal?
- Did you care when the NPC died?
- Did you debate sharing information with NPCs?
- Did the NPC feel like a person or a tool?

---

## üìù Changelog

### v1.0 (2025-01-01)
- NPC companion system designed
- 6 example NPCs created (archetypes)
- Betrayal mechanics defined (fatal flaws)
- Death system (permanent consequences)
- Leaving & returning (Option B - redemption arcs)
- Whisper behavior patterns established
- Divine Favor for NPCs integrated

---

## üîó Related Documents
- **QUEST_SCENARIOS.md** - NPCs assigned per scenario
- **TRUST_BETRAYAL_MECHANICS.md** - How NPC approval affects party
- **DIVINE_COUNCIL_SYSTEM.md** - NPCs in Divine voting
- **AI_GM_ENHANCEMENTS.md** - Proactive NPC behavior
- **MECHANICS.md** - NPC rules integration

---

**Status:** ‚úÖ Complete - NPC Companion System Fully Designed
**Impact:** Transforms party from "2 players" to "living group with internal conflict"

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Arcane Codex - Properly Paced Game Flow</title>
    <link rel="stylesheet" href="css/battle_scene_animations.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Spectral:ital,wght@0,300;0,400;0,600;1,400;1,600&display=swap');

        :root {
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #8B7355;
            --bg-dark: #09090b;
            --bg-panel: rgba(42, 36, 30, 0.95);
            --text-light: #E4D4B4;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Spectral', serif;
            background: linear-gradient(180deg, #0A0812 0%, #1A1425 100%);
            color: var(--gold);
            line-height: 1.8;
        }

        .game-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 40px;
            min-height: 100vh;
        }

        /* === EPISODE STRUCTURE === */
        .episode {
            opacity: 0;
            animation: fadeIn 1s ease-in forwards;
        }

        .episode.visible { opacity: 1; }
        .episode.hidden { display: none; }

        /* Episode Title Card */
        .episode-title-card {
            text-align: center;
            padding: 100px 20px;
            margin-bottom: 80px;
        }

        .episode-number {
            font-family: 'Cinzel', serif;
            font-size: 18px;
            color: var(--gold-dark);
            letter-spacing: 3px;
            margin-bottom: 20px;
        }

        .episode-title {
            font-family: 'Cinzel', serif;
            font-size: 56px;
            font-weight: 900;
            color: var(--gold-light);
            letter-spacing: 4px;
            margin-bottom: 30px;
            text-shadow: 0 0 30px var(--gold-light);
        }

        .episode-subtitle {
            font-size: 20px;
            color: var(--gold-dark);
            font-style: italic;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Context Screen (Between Episodes) */
        .context-screen {
            background: var(--bg-panel);
            border: 3px solid var(--gold-dark);
            border-radius: 12px;
            padding: 50px;
            margin: 80px 0;
        }

        .context-title {
            font-family: 'Cinzel', serif;
            font-size: 32px;
            color: var(--gold-light);
            margin-bottom: 30px;
            text-align: center;
        }

        .context-section {
            margin: 30px 0;
        }

        .context-label {
            font-family: 'Cinzel', serif;
            font-size: 18px;
            color: var(--gold);
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .context-value {
            font-size: 16px;
            color: var(--text-light);
            padding-left: 20px;
        }

        .context-stat {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.3);
            border-left: 3px solid var(--gold);
            border-radius: 4px;
        }

        .stat-label {
            font-weight: 600;
            color: var(--gold);
        }

        .stat-value {
            color: var(--text-light);
        }

        /* Story Content */
        .story-section {
            margin: 40px 0;
        }

        .story-text {
            font-size: 20px;
            color: var(--text-light);
            margin-bottom: 25px;
            text-align: justify;
        }

        .story-text strong {
            color: var(--gold-light);
        }

        .story-dialogue {
            font-style: italic;
            color: #9B8A6B;
            padding-left: 40px;
            border-left: 3px solid var(--gold-dark);
            margin: 25px 0;
        }

        .story-emphasis {
            font-size: 24px;
            font-weight: 600;
            color: var(--gold-light);
            text-align: center;
            margin: 50px 0;
            padding: 30px;
            background: rgba(255, 215, 0, 0.05);
            border-top: 2px solid var(--gold);
            border-bottom: 2px solid var(--gold);
        }

        /* Scene Divider */
        .scene-break {
            text-align: center;
            margin: 60px 0;
            color: var(--gold-dark);
            font-size: 32px;
        }

        /* Action Choices */
        .action-prompt {
            margin: 60px 0;
            padding: 40px;
            background: var(--bg-panel);
            border: 3px solid var(--gold-dark);
            border-radius: 12px;
        }

        .action-prompt-title {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            color: var(--gold-light);
            margin-bottom: 30px;
            text-align: center;
        }

        .action-button {
            display: flex;
            align-items: center;
            gap: 20px;
            width: 100%;
            padding: 25px 30px;
            margin: 15px 0;
            background: linear-gradient(135deg, #2A1810 0%, #4A3428 100%);
            border: 2px solid var(--gold);
            color: var(--gold);
            font-family: 'Spectral', serif;
            font-size: 18px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .action-button:hover {
            background: linear-gradient(135deg, #3A2820 0%, #5A4438 100%);
            border-color: var(--gold-light);
            color: var(--gold-light);
            transform: translateX(10px);
        }

        .action-icon {
            font-size: 32px;
        }

        .action-text {
            flex: 1;
        }

        .action-consequence {
            font-size: 14px;
            color: var(--gold-dark);
            margin-top: 5px;
        }

        /* Continue Button */
        .continue-section {
            text-align: center;
            margin: 60px 0;
        }

        .continue-btn {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            padding: 20px 50px;
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            color: #0A0908;
            font-family: 'Cinzel', serif;
            font-size: 18px;
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 25px rgba(212, 175, 55, 0.4);
        }

        .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 35px rgba(212, 175, 55, 0.6);
        }

        /* Status Panel (Fixed) */
        .status-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-panel);
            border: 2px solid var(--gold-dark);
            border-radius: 8px;
            padding: 20px;
            min-width: 250px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        }

        .status-title {
            font-family: 'Cinzel', serif;
            font-size: 16px;
            color: var(--gold-light);
            margin-bottom: 15px;
            text-align: center;
            letter-spacing: 2px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 14px;
        }

        .status-label {
            color: var(--gold-dark);
        }

        .status-value {
            color: var(--gold-light);
            font-weight: 600;
        }

        .status-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .status-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #D4AF37, #FFD700);
            transition: width 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .game-container { padding: 40px 20px; }
            .episode-title { font-size: 36px; }
            .status-panel { position: static; margin-bottom: 30px; }
        }
    </style>
</head>
<body>
    <!-- Status Panel -->
    <div class="status-panel">
        <div class="status-title">PARTY STATUS</div>
        <div class="status-item">
            <span class="status-label">Episode:</span>
            <span class="status-value" id="current-episode">1 of 5</span>
        </div>
        <div class="status-item">
            <span class="status-label">Party Trust:</span>
            <span class="status-value" id="trust-value">55/100</span>
        </div>
        <div class="status-bar">
            <div class="status-bar-fill" id="trust-bar" style="width: 55%"></div>
        </div>
        <div class="status-item" style="margin-top: 15px;">
            <span class="status-label">Location:</span>
            <span class="status-value" id="location">Temple Crypt</span>
        </div>
        <div class="status-item">
            <span class="status-label">Quest:</span>
            <span class="status-value" id="quest">Investigate</span>
        </div>
    </div>

    <div class="game-container">
        <!-- ============================================ -->
        <!-- EPISODE 1: Discovery -->
        <!-- ============================================ -->
        <div class="episode visible" id="episode1">
            <div class="episode-title-card">
                <div class="episode-number">EPISODE 1</div>
                <h1 class="episode-title">THE DESCENT</h1>
                <p class="episode-subtitle">Your party investigates rumors of dark magic beneath the old temple</p>
            </div>

            <div class="story-section">
                <p class="story-text">
                    The village elder's words echo in your mind: <em>"No one who enters the crypt returns. But if you don't stop what's down there, the entire region will fall to darkness."</em>
                </p>

                <p class="story-text">
                    Your party stands at the entrance. <strong>Thorne the Fighter</strong> checks his sword. <strong>Aria the Ranger</strong> nocks an arrow. <strong>Kaelen the Mage</strong> murmurs a protective ward.
                </p>

                <p class="story-dialogue">
                    <strong>Thorne:</strong> "We've faced worse. Stay together, watch each other's backs."
                </p>

                <p class="story-dialogue">
                    <strong>Aria:</strong> "Something feels wrong about this place. The animals won't go near it."
                </p>

                <p class="story-text">
                    The stone steps descend into darkness. Your torchlight reveals ancient carvings on the walls‚Äîwarnings in a dead language.
                </p>
            </div>

            <div class="scene-break">‚öî ‚öî ‚öî</div>

            <div class="story-section">
                <p class="story-text">
                    As you descend, the temperature drops. Frost forms on the walls. <strong>Kaelen</strong> stops suddenly, his hand on a glowing rune.
                </p>

                <p class="story-dialogue">
                    <strong>Kaelen:</strong> "This is a warning seal. 'Beyond lies death eternal. Turn back or be consumed.' The magic is old... and powerful."
                </p>

                <p class="story-text">
                    Beyond the archway, you see skeletal remains‚Äîdozens of them. These were adventurers like you. They didn't turn back.
                </p>
            </div>

            <div class="action-prompt">
                <div class="action-prompt-title">What do you do?</div>
                <button class="action-button" onclick="chooseAction1('investigate')">
                    <span class="action-icon">üîç</span>
                    <div class="action-text">
                        Investigate the remains for clues
                        <div class="action-consequence">Gain information, but takes time</div>
                    </div>
                </button>
                <button class="action-button" onclick="chooseAction1('proceed')">
                    <span class="action-icon">‚öîÔ∏è</span>
                    <div class="action-text">
                        Press forward immediately
                        <div class="action-consequence">Maintain surprise, but enter blind</div>
                    </div>
                </button>
                <button class="action-button" onclick="chooseAction1('prepare')">
                    <span class="action-icon">üõ°Ô∏è</span>
                    <div class="action-text">
                        Prepare defensive spells and traps
                        <div class="action-consequence">Safer, but uses resources</div>
                    </div>
                </button>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- EPISODE 2: Context Screen -->
        <!-- ============================================ -->
        <div class="episode hidden" id="episode2-context">
            <div class="context-screen">
                <h2 class="context-title">‚öîÔ∏è SITUATION REPORT ‚öîÔ∏è</h2>

                <div class="context-section">
                    <div class="context-label">YOUR DECISION:</div>
                    <div class="context-value" id="player-choice">You chose to investigate the remains...</div>
                </div>

                <div class="context-section">
                    <div class="context-label">WHAT HAPPENED:</div>
                    <div class="context-value">
                        Among the bones, Aria finds a tattered journal. The final entry reads: "The guardian is unkillable by steel alone. Only when weakened by‚Äî" The rest is destroyed. But it's something.
                    </div>
                </div>

                <div class="context-section">
                    <div class="context-label">PARTY STATUS CHANGES:</div>
                    <div class="context-stat">
                        <span class="stat-label">Party Trust:</span>
                        <span class="stat-value">55 ‚Üí 58 (+3) <em>Smart decision builds confidence</em></span>
                    </div>
                    <div class="context-stat">
                        <span class="stat-label">Time Elapsed:</span>
                        <span class="stat-value">+15 minutes <em>Guardian has time to prepare</em></span>
                    </div>
                    <div class="context-stat">
                        <span class="stat-label">Information Gained:</span>
                        <span class="stat-value">Clue: Guardian has a weakness</span>
                    </div>
                </div>

                <div class="context-section">
                    <div class="context-label">CURRENT SITUATION:</div>
                    <div class="context-value">
                        Armed with this knowledge, you enter the main chamber. The air grows colder still. Your breath mists. And then... you hear it. A low growl from the shadows.
                    </div>
                </div>
            </div>

            <div class="continue-section">
                <button class="continue-btn" onclick="startEpisode('episode2')">
                    Continue ‚Üí Enter the Chamber
                </button>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- EPISODE 2: The Guardian -->
        <!-- ============================================ -->
        <div class="episode hidden" id="episode2">
            <div class="episode-title-card">
                <div class="episode-number">EPISODE 2</div>
                <h1 class="episode-title">THE GUARDIAN</h1>
                <p class="episode-subtitle">Face the ancient evil that guards the crypt</p>
            </div>

            <div class="story-section">
                <p class="story-text">
                    The chamber is vast, supported by obsidian pillars that seem to drink in your torchlight. At the center, a massive stone sarcophagus lies open and empty.
                </p>

                <p class="story-text-emphasis" style="color: #FF4444;">
                    "You... should not... have come here..."
                </p>

                <p class="story-text">
                    From the deepest shadows, it emerges. Towering. Skeletal. Eyes burning with hellfire. The Crypt Guardian. Its very presence radiates ancient malevolence.
                </p>

                <p class="story-dialogue">
                    <strong>Thorne:</strong> "Positions! Aria, high ground! Kaelen, hit it with everything you've got!"
                </p>

                <p class="story-text">
                    The guardian raises a massive bone sword. Battle is inevitable.
                </p>
            </div>

            <div class="action-prompt">
                <div class="action-prompt-title">How do you engage?</div>
                <button class="action-button" onclick="startBattle()">
                    <span class="action-icon">‚öîÔ∏è</span>
                    <div class="action-text">
                        Charge directly - aggressive assault
                        <div class="action-consequence">High risk, high reward</div>
                    </div>
                </button>
                <button class="action-button" onclick="startBattle()">
                    <span class="action-icon">üõ°Ô∏è</span>
                    <div class="action-text">
                        Defensive formation - weather the storm
                        <div class="action-consequence">Safer, longer fight</div>
                    </div>
                </button>
                <button class="action-button" onclick="startBattle()">
                    <span class="action-icon">üîÆ</span>
                    <div class="action-text">
                        Exploit the weakness from the journal
                        <div class="action-consequence">Requires the clue you found</div>
                    </div>
                </button>
            </div>
        </div>

        <!-- EPISODE 3, 4, 5 would continue with same structure... -->
        <!-- For demo, we'll jump to end after battle -->

        <div class="episode hidden" id="episode-finale">
            <div class="episode-title-card">
                <div class="episode-number">DEMO COMPLETE</div>
                <h1 class="episode-title">WELL PACED</h1>
                <p class="episode-subtitle">Notice the rhythm: Episode ‚Üí Context ‚Üí Decision ‚Üí Episode</p>
            </div>

            <div class="context-screen">
                <h2 class="context-title">GAME FLOW STRUCTURE</h2>

                <div class="context-section">
                    <div class="context-label">PROPER RHYTHM:</div>
                    <div class="context-value">
                        1. <strong>Episode Title</strong> - Sets context<br>
                        2. <strong>Story Content</strong> - Player reads and absorbs<br>
                        3. <strong>Player Choice</strong> - Agency and strategy<br>
                        4. <strong>Context Screen</strong> - Shows consequences<br>
                        5. <strong>Continue Button</strong> - Player controls pacing<br>
                        6. <strong>Next Episode</strong> - Repeat
                    </div>
                </div>

                <div class="context-section">
                    <div class="context-label">WHY THIS WORKS:</div>
                    <div class="context-stat">
                        <span class="stat-label">Clear Breaks</span>
                        <span class="stat-value">Episodes feel distinct</span>
                    </div>
                    <div class="context-stat">
                        <span class="stat-label">Player Control</span>
                        <span class="stat-value">They advance when ready</span>
                    </div>
                    <div class="context-stat">
                        <span class="stat-label">Visible Consequences</span>
                        <span class="stat-value">Choices matter visibly</span>
                    </div>
                    <div class="context-stat">
                        <span class="stat-label">Context Awareness</span>
                        <span class="stat-value">Players always know where they are</span>
                    </div>
                </div>
            </div>

            <div class="continue-section">
                <button class="continue-btn" onclick="location.reload()">
                    üîÑ Restart Demo
                </button>
            </div>
        </div>
    </div>

    <script src="js/battle_scene_animations.js"></script>
    <script>
        let currentEpisode = 1;
        let partyTrust = 55;

        function updateStatus(episode, trust, location, quest) {
            if (episode) document.getElementById('current-episode').textContent = episode;
            if (trust !== undefined) {
                partyTrust = trust;
                document.getElementById('trust-value').textContent = trust + '/100';
                document.getElementById('trust-bar').style.width = trust + '%';
            }
            if (location) document.getElementById('location').textContent = location;
            if (quest) document.getElementById('quest').textContent = quest;
        }

        function hideAllEpisodes() {
            document.querySelectorAll('.episode').forEach(ep => {
                ep.classList.remove('visible');
                ep.classList.add('hidden');
            });
        }

        function startEpisode(episodeId) {
            hideAllEpisodes();
            const episode = document.getElementById(episodeId);
            episode.classList.remove('hidden');
            setTimeout(() => episode.classList.add('visible'), 100);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function chooseAction1(choice) {
            currentEpisode = 2;
            updateStatus('2 of 5', 58, 'Crypt Chamber', 'Survive');

            // Show context screen
            let choiceText = '';
            if (choice === 'investigate') {
                choiceText = 'You chose to investigate the remains. This took time, but you gained valuable information.';
            } else if (choice === 'proceed') {
                choiceText = 'You pressed forward immediately, maintaining the element of surprise.';
            } else {
                choiceText = 'You prepared defensive spells and traps, using valuable resources.';
            }

            document.getElementById('player-choice').textContent = choiceText;
            startEpisode('episode2-context');
        }

        function startBattle() {
            updateStatus('3 of 5', null, 'Battle!', 'Survive');

            playBattleIntro({
                enemyName: 'CRYPT GUARDIAN',
                enemyIcon: 'üëπ',
                flavorText: 'An ancient evil awakens!',
                battleType: 'boss',
                onComplete: () => {
                    updateStatus('5 of 5', 47, 'Crypt Exit', 'Complete');
                    startEpisode('episode-finale');
                }
            });
        }

        console.log('Properly Paced Game Flow Ready!');
        console.log('Notice the rhythm:');
        console.log('- Episode title gives context');
        console.log('- Story lets player read');
        console.log('- Choice gives player agency');
        console.log('- Context screen shows consequences');
        console.log('- Continue button lets player control pacing');
    </script>
</body>
</html>
